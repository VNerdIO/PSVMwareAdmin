Function Get-VMPerformanceOverview{
$DaysAgo = -7
$hbps = $hbp | Select-Object Name,@{n="OS";e={$_.Guest.OSFullName}},NumCpu,MemoryGB,@{n="SpaceGB";e={[math]::round($_.ProvisionedSpaceGB,1)}},@{N="CPUUsageMhz" ; E={[Math]::Round((($_ | Get-Stat -Stat cpu.usagemhz.average -Start (Get-Date).AddDays($DaysAgo) -IntervalMins 5 | Measure-Object Value -Average).Average),2)}},@{N="MemoryUsagePercent" ; E={[Math]::Round((($_ | Get-Stat -Stat mem.usage.average -Start (Get-Date).AddDays($DaysAgo) -IntervalMins 5 | Measure-Object Value -Average).Average),2)}},@{N="NetworkUsageKBps" ; E={[Math]::Round((($_ | Get-Stat -Stat net.usage.average -Start (Get-Date).AddDays($DaysAgo) -IntervalMins 5 | Measure-Object Value -Average).Average),2)}},@{N="DiskUsageKBps" ; E={[Math]::Round((($_ | Get-Stat -Stat disk.usage.average -Start (Get-Date).AddDays($DaysAgo) -IntervalMins 5 | Measure-Object Value -Average).Average),2)}},@{N="DiskLatency" ; E={[Math]::Round((($_ | Get-Stat -Stat Disk.MaxTotalLatency.Latest -Start (Get-Date).AddDays($DaysAgo) -IntervalMins 5 | Measure-Object Value -Average).Average),2)}}
}